{% extends "layout.njk" %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8 max-w-5xl">
  <!-- Page Header -->
  <div class="flex flex-col lg:flex-row justify-between items-center mb-8 gap-4">
    <h1 class="text-4xl md:text-5xl font-bold kainos-text-gradient">{{ title }}</h1>
    <a href="/jobs/{{ jobRole.id }}/details" class="btn-kainos-outline shadow-lg hover:shadow-xl inline-flex items-center gap-2">
      {{ icon('arrow-left', 'h-5 w-5') | safe }}
      <span>Cancel</span>
    </a>
  </div>

  <!-- Form Card with DaisyUI -->
  <div class="card bg-base-100 shadow-2xl">
    <div class="card-body">
      <h2 class="card-title text-2xl text-kainos-primary mb-2">Edit Job Role Information</h2>
      <p class="text-base-content/70 mb-6">Update the details for this job role</p>
      
      <div class="divider"></div>
      
      <form id="editJobForm" action="/jobs/{{ jobRole.id }}/edit" method="POST">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <!-- Job Name -->
          <div class="form-control">
            <label class="label" for="name">
              <span class="label-text font-semibold">Job Name *</span>
            </label>
            <input 
              type="text" 
              id="name"
              name="name" 
              value="{{ jobRole.name }}"
              placeholder="e.g., Software Engineer" 
              class="input input-bordered input-primary w-full" 
              required
            />
          </div>

          <!-- Location -->
          <div class="form-control">
            <label class="label" for="location">
              <span class="label-text font-semibold">Location *</span>
            </label>
            <select id="location" name="location" class="select select-bordered select-primary w-full" required>
              {% for location in locationOptions %}
              <option value="{{ location }}" {% if location == jobRole.location %}selected{% endif %}>{{ location }}</option>
              {% endfor %}
            </select>
          </div>

          <!-- Capability -->
          <div class="form-control">
            <label class="label" for="capabilityId">
              <span class="label-text font-semibold">Capability *</span>
            </label>
            <select id="capabilityId" name="capabilityId" class="select select-bordered select-primary w-full" required>
              {% for capability in capabilities %}
              <option value="{{ capability.id }}" {% if capability.id == jobRole.capabilityId %}selected{% endif %}>{{ capability.name }}</option>
              {% endfor %}
            </select>
          </div>

          <!-- Band -->
          <div class="form-control">
            <label class="label" for="bandId">
              <span class="label-text font-semibold">Band *</span>
            </label>
            <select id="bandId" name="bandId" class="select select-bordered select-primary w-full" required>
              {% for band in bands %}
              <option value="{{ band.id }}" {% if band.id == jobRole.bandId %}selected{% endif %}>{{ band.name }}</option>
              {% endfor %}
            </select>
          </div>

          <!-- Closing Date -->
          <div class="form-control">
            <label class="label" for="closingDate">
              <span class="label-text font-semibold">Closing Date *</span>
            </label>
            <input 
              type="date" 
              id="closingDate"
              name="closingDate" 
              value="{{ jobRole.closingDate }}"
              class="input input-bordered input-primary w-full" 
              required
            />
          </div>

          <!-- Status -->
          <div class="form-control">
            <label class="label" for="statusId">
              <span class="label-text font-semibold">Status *</span>
            </label>
            <select id="statusId" name="statusId" class="select select-bordered select-primary w-full" required>
              {% for status in statuses %}
              <option value="{{ status.id }}" {% if status.name == jobRole.status %}selected{% endif %}>{{ status.name }}</option>
              {% endfor %}
            </select>
          </div>

          <!-- Open Positions -->
          <div class="form-control md:col-span-2">
            <label class="label" for="openPositions">
              <span class="label-text font-semibold">Number of Open Positions</span>
            </label>
            <input 
              type="number" 
              id="openPositions"
              name="openPositions" 
              value="{{ jobRole.openPositions }}"
              placeholder="e.g., 3" 
              class="input input-bordered input-primary w-full" 
              min="1"
            />
            <label class="label">
              <span class="label-text-alt">Specify how many positions are available for this role</span>
            </label>
          </div>

          <!-- Job Description -->
          <div class="form-control md:col-span-2">
            <label class="label" for="description">
              <span class="label-text font-semibold">Job Description</span>
            </label>
            <textarea 
              id="description"
              name="description" 
              class="textarea textarea-bordered textarea-primary h-32 w-full" 
              placeholder="Provide a brief description of the role and its key objectives..."
            >{{ jobRole.description }}</textarea>
            <label class="label">
              <span class="label-text-alt">Describe the role's purpose and main objectives</span>
            </label>
          </div>

          <!-- Job Responsibilities -->
          <div class="form-control md:col-span-2">
            <label class="label" for="responsibilities">
              <span class="label-text font-semibold">Key Responsibilities</span>
            </label>
            <textarea 
              id="responsibilities"
              name="responsibilities" 
              class="textarea textarea-bordered textarea-primary h-32 w-full" 
              placeholder="List the main responsibilities for this role (one per line)..."
            >{{ jobRole.responsibilities }}</textarea>
            <label class="label">
              <span class="label-text-alt">Enter each responsibility on a new line</span>
            </label>
          </div>
        </div>

        <!-- Job Spec URL (SharePoint Link) -->
        <div class="form-control mt-6">
          <label class="label" for="jobSpecUrl">
            <span class="label-text font-semibold">SharePoint Link / Job Specification URL</span>
          </label>
          <label class="input input-bordered input-primary flex items-center gap-2">
            {{ icon('link', 'h-5 w-5 opacity-70') | safe }}
            <input 
              type="url" 
              id="jobSpecUrl"
              name="jobSpecUrl" 
              value="{{ jobRole.jobSpecUrl }}"
              placeholder="https://sharepoint.company.com/job-spec.pdf" 
              class="grow"
            />
          </label>
          <label class="label">
            <span class="label-text-alt">Optional: Link to detailed job specification document on SharePoint or other location</span>
          </label>
        </div>

        <!-- Form Actions inside card -->
        <div class="divider"></div>
        <div class="card-actions justify-end gap-3 mt-6">
          <a href="/jobs/{{ jobRole.id }}/details" class="btn-kainos-outline shadow-md hover:shadow-lg inline-flex items-center gap-2">
            {{ icon('x', 'h-5 w-5') | safe }}
            <span>Cancel</span>
          </a>
          <button type="submit" class="btn-kainos shadow-lg hover:shadow-xl inline-flex items-center gap-2">
            {{ icon('check', 'h-5 w-5') | safe }}
            <span>Update Job Role</span>
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}
